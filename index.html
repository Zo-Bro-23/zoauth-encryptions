<html>
    <body>
        <p id= 'p'></p>
    </body>
    <script>
        function func(){
        let userPassword
        let encryptionCoords
        let redirect_uri
        let randomKey1
        let randomKey2
        let randomKey3
        let myRandomKey = 'C6.duK05_0bX0iZXu7_YfAH4hn069GzwhMXzjIi.Vo30351bbvMGybq87D4krns9m-PG1MNx852WlLvctjQzoopJot_L70DyoQylyMYawbSjmpvHlGqLDDVx0enItxLDbIwz4VDPRE5PspYQ~_AW2Y9HdWXxhZzjPQV_VHDPQjRBV0YgXMPLxaPpADw_KaoJzaODqq3NLKP0f7y_iKtsbTxkjmitFvB_VSzOR8H5_KVpOONtDZ9sng~-BpcJOmgYrycrmQmB9OXUyHY7kitHC7BmvhLbQfQG.urI8R46fkC0hAJWe_u_6Zhr2CMd-JfFgcXCQjYjq1.AKBqE3efF5a6uhZ2nRoO5I35s67Zj6j4rA8SenhNL01d7_OCy0-H6LztfHtqhVW1uAADnz62eNyB4wcAkby1q5zy2VkR7VK6hlGOLQ0js3dL__v5xmuW648gPGopBHDFtc8_uaqt9gWK9J-nmZZukwnsd3OnMhc2MMg3WqHSEwcLZKrbLsjA5gtbQh0ZbQPvGjtdP2uQpXLr0gwF~71tQRFs.OEY9mslzABxtjHfD-F7LaZ3YgDPkBnunOJXJ~O6x2oQ-U5-vvScEiQwEqrNEo.2KQvbnPXdJBkb~wi6afpzddEFylSDQO87PgjoE55ebkee~TYbJayD~4alLQ6vATOhQ.Z40gSutcqKzbcRlWOMFrB22wXaWZt_.HzeeTlFpHrkUchvn_2Qy6VaJbbWJCUlGMqbvyleT~nrYXSFBnNb20LQa25B7njmOU4R7_SCiRTHGm3phPwRXVvIAft9h7~iJdFNkGu2JMg8abPuWByfjsCtG0uc5hbJ0GGnKQdURjIWRaDx4jEdSve.pF_bmCpbYlmwY2vMUXsd_Xij-5eUVjoW6hF-11RnwYGGZ5aoZj105VuueW~WYsqxzyHMLl1Kv.U2~q~.SH9ZvmLMNrJe3Zj.NkO-CAASBtFNVYXjOSalN8Z_z43WeyXuI3nih8RvcwZ362p2FzmX9ja10w3aPaQsdYm2BY6glWadA10IRaKTrjwRxk0VMi~-pdDW8xjx-xackRVXayc2JmgIyleNGTVwW8jjp1cbItAMQaq15yDmA1WOiooMQPR.qL3cZ2owH-tS2aWTnuU8dwXfezG3RqPDPJk10n1FQ_Db4xjUnSyH-4THYpnihYXZbzp_Xk-HSL2gbSRJHJz2ErA8vKenNAnZY_OIhhhphND2MA4AuqUdz6eHs9XGDS_6ig9XhvR5fM.rxD1FR85ThvaUDKIE5gEnzv6IuPS1cnpCpVNVmtReIUFt2NzyCUVDI6mQ_eKB071I1OhH0FGS_tZSKaklyN2IzYC2xQUAyfeR7MsC0F4bGcJIDshvbVX2w-533Fogqib1Uv2KI.czker3Z0--xH2U.TI2e~ALtxqB0paKz.60vV_MVYR1-6H.d21GC~eLAZLJr~T0BRHrQa9C.hG12pb1fVYtebiMSph3KAyfd9W-wVaaAe5lPw4NiHhY9YXdUh5uaq_00K3Y2XLmu6dqPfl1ddUjQk3JBQFVtKUt~hqC3mXeQyzLRYEvWds9tCm8zz7G-jCp6_AtM1tAm5tQ8yvrVNXZkhXD.ullUYSEswwnkPo0zzYwIs3S~pLLkOBH~YxV~CBHIZU8JOaKEegDB_PLROm4~TZWnsDKq6OYBkGbx84yPRCu~xo~OwgAnp-rMzUGpVw9CGgX.JFtCIOeo~HMLOPGcdpHj2brX4Erqj5UURCe7vXSr6v5eeR0__p4d5v_y_PEOTT7q-ID8GD7uv6NXHatiZoLlidRTEJl6plRe~Z69lTKjov7J~uuf5d8rU9UMufFHuz5wl8WSitcFp41LfKnET02I~I~x3TZoHhnjOKjIbFl1xudjV448FM17eCitD3-sSTGUMmaXen-ho3.0Il59LlwjZUjA_j9L_4opM597pD0jbSF_J~0cPt-iF_1S4Re7y8ouv0_p.6u2Qm-Xhxv.Rs0s2EIxno~yfIGnLW7TRMyb-pw_zCh1iQnTO377UpMuTtFRu3RkIXOM-Zttxx_w6d-KQRrrASdEbR-K0i9EW2~GIGjb8Y-QdUgfKgv8hkg5yVgvcjJDwFg9rh53R.0Q71X4WGUPCCRUuChxve-LeQ24aqwsV3Y0-wbcwGJqj6TIInNq4wK-wV.DO8LobA~o8rUcngZXNt3o3Tzsg8byFhpBO.ihsQueth.aMmfmh.o8zXhuCcb7JQf4LVcpnRLhyREw92FtjJ~syRW3TzrMol_Nk0oMCW9SHL7xoZ21Muq4And8ZKwXPO6kADpa_qGKqg8Y1KYnmWh61zojm8Zbg~aG2dOndLop_1gs.4Cr9VaQbq77qWd31glhqUlpTRu.-_y8Zk5Wr3z7Y.ocxPkyKDYZGs_gOq-Ujlh8irUiDydGVPYy9zNU53I~W5hXL5ru7S.UeFvT6mlM46oJrsU.mdk-XyujzJfW623L8DLM7p9eWew92buQo.6C9r-r14MGnkJ2fmqnD_s.a3ksO6b9itYR_jCY0ZBjxEQYctUjQxYL5rtR~wYd2rMqz53~c.XwBk.7mLY6A8s3Q2_~y1nain.IcPpezCyjl.yicI3VA560xnkPvo24HXRwkE79wtROUKozhGKMxWUeTylbmdQhpGIbRwzun_3dKvFp4OI_xI5PPP48zk2nTStSGRo09OghrJye2~nfWvGsAoQMWfdGdDU19oJkGQrqTkyJ89kluOZpnCPzK3fUs7SHalIqCq0ScIHIBiyRzk3qX-UruVxSvQ9eQdj0nrfTkPVW61bm4WEeybtz_LY7Bj~51_SOEfitPmIAYHhEviO25LLK4xncvTY4bmNVKkyilGlAMXtp9MbiAA419aryKQazb3cVo.W5puTNBylY2czcbRtfHJxtatJOWwtRZ8mg~2LxTCnOTci.MEEXWpQGbV9mG-ZAJMeBB39brJlodJfDJUfZjkZRI4gx0VUo1UxIyY8_srob7t6mXIoYLkzKlu4uzriMPcmIrK4n6Yg7QIOPvwfU1r5hQAyROJq3_W3_62lqjb5KlMGpCM32zRqrNCLe2hgPCYRrkxpGsc4x8oJQFC-RfllYI1IdYW8x54usjKO..E3tUbhDdFnV7xkdOuc.CGkJWMQ7PH7i98x~.8cCbviB_93xf_k~tEH-nuSBtC5g5OLwqrgBKO_M~CORL6LWm5s36bGt2Fcev26H6nT2V6LPpSe.nfMMzjn1JZD.ShXYqrfmFr4t51QfZM-jNynW_H2aSn3CtCCJgopCyaTAuuXwFHT9EXfNXdujdlgDuqZiID2apbCMpJCHIjCQj.qbAR5Djvz6oGlmH3ZWR_qBw-V11YcZLF~Xe4CvkuF7BDKe2Uyd8Fnfkgzpvqqs.3O4VAOlHtuZKNxwV1ci-JnVTfLWtACv3OPrXYtfpwOD3Udm4U2Dk7laUOccnqbwjtvo_~Ts.Ucr7iorK1GINT7AoMChhX5XMDaeSM9LD9UU0C0r-LRITRdpCyxyLoSVrgpN2AHLNLIqJqVlozFsfkGimFpnNxeebjXNrujn.UIxwOEat0c_-s_FYvJ3WKa9R~xVmpH~XDoNzqeYGNCFHg7sJWnAu-yobf0XtowhQVH4vME4FID7GUnfrKE6HBNX-qLC51~GdQ3K13xdd5XC~WaFPqscmLRMqTdWXsA3EBXGUtgQUBlP1V9CwGpo7SZ4A3sL~NT2EEjj503aurIdyzKE4eN1n0Z-KYjw6zdKa.IzBnArBSyFTG9nkTpeQ8WlD.aU~9mMb0l6BwT8g4sU31la4iL6eoxDQrCAgce9gWnqF1U~UjAps30tXajGrGgUY9hgTeLHVYdSkE1HoqRSOVXPLreBdI9ZCML-~yJ16yuGP0V6k-ma-5h_jmQzPBdJ7YbPUXL9FZhRO89izsjYyS1n~OzWrQL8Ic_thhmi9oBZsak3svuaQT8dRkx2a4WPnNDFnS2pCUGPINKR8W4wtyf_v5oo2eLEGlPLBpqd38ym2KMkxxra~MiJekNbXEw.yNJCNduLiEJnigmV_fEhoHkBHTrDPLIxXKFisypbWwOQtM6PfHRLZ0~hiP07k8jJVb8nOHAtUg0BbOoxDmTi83qDqASt3kXrpcdjp8aEVns6_bDF77ny.WHP-RPgLcPsQaj.rC0PAQ29M6oW~qDpdw1O8nZsrW-jTRrioY-2PTnflhDQfPydn6gMThcj9VN3CAvIFhaUpHZdbr45AH.U_qX~0fPlEK~eqyCh5VzMMcwzs405eFZNiRXvJPsWIX4pQU10gydLfVMWlLGfgw7eDwpUjZGIGZ0cMw4lRSGIWEXpULKyGpb5o8x08sE4bQ5-.dKmQK_qP0rYGPTx_6-9.C-ByHQ9U.naysi6nFnq389iAGF.oVSZLcQ7cv-yuhz-gZv4t5nwxSCESGrKMtICkPgadSHP6zBs-tHKIQobvG~ubI21Yq7NE3vg4d3UXrB~MVkHYg0MMwobBqxzHjjYQSwvhurDdITUvbW4d7Y8bYNAN.8oWzciEhu5Itio-KYAkzdgaOXvmfmEQoVyCU7ECiMCwZQePx~DG.~tmEpuYbI6TAn3Lap_QzQRiMgFspup3nVF3T1wlTgJ4vTAwhEBQ3lWlB5K.Kv7nIvF1ygqUiTfI3QkJqaxYdjO7H6UOT4zqiuskaWIaI5F2f_YPZsGD7RXTuWNP3jeBxdELUvGWnsmH7Gq00~k8nn_-Z46S4id.ez.2UtTWBIyNT.ZXGzrbZWDU5xH12Pog3gCPRSlicbJuCpiqJ1ZNR_slk5BOg7-~X1~6Py_YqGk9Ekcy7S8V6J24~I~8R2bY_REBPE-U-GLzW6inIdIt_OxRyD.Ccqtgh8NB.EgvqdupRX-nx43ZbuEBzA5WDmUkA1IzRQiXNeeCQVVj0c8_fy_t9DK6d6A4e_pdz3BLirb_HCtJfO-QvC4XVY-dWUixXTacxrUbNwGiOF7h04l2b~je2T6WvW_3~PSGKZRKCT1H-ZZHVZ2gsbG9q3D6N86ChqLWFWIJOKafTGaEuZ1x8fHqyKn6510uKLT0eiyCRL3tAy0IYtzesdtci.8hMq9f.GZYOE0JSwSg~MucU4I1CrMWuR6lYr49muDgzr2Yvjq~P._mNCO0AHZ42FV2Ss_OSXisnzGzXgGjs.Aa7pJodkm8T6tvzJD~NDIiXaGRJLLQOQkko~_oGzpUiBwBPvvXz5PUXkqGXK4R97f4PwoW.OKUJ3AsFUZ~V6uxVcpXgsDdIbuFqQRd~yl__n8ypHAx0yltmKpTrn3yUe7hXbm4F3njdmB8b7zlZ2pu1.XZb3OT2QJ-T5Hp6fpbZvy4k~~8XrqE-a451n23ORa0nQZKxvx_cew3_Aanmj0L1fFcW12wF2h1EnOsFvpVuyvncLjpCCG6ofdU1ILlcGz~O_8zGNM9f_ufghfX3pLLrvtij.gapJk01KzQgkhk~oC9n..AC3La_knQtvzNj5LiZibujc-OoUhPqCq68Je7TQrVcsHIKcm7icDqBKyCHvnaLEaBPRYxC6K4lD0q~n-w1UQTkNhc6m1EIk7hjx4tf~xEBGJxAtz8Tx6Lk~QpT_l.IWjYajuLikOB5ALp9wa09W-5mnHD4V0NE~gia3KZLcx-HJCcbVUMdgOaFmX495OKRolLx61kH0T3I4S02x33VuRYriv_qJluHdvIKhdCjcnWNgMQutArgxIetKI~yE7.-D9NuZDdESkRRk8dWmwU4b3SaLhd5C4N-rDEljHXh7aNnlfbP03xHMFiv1H.4UW1E8-p74ao59kAC0F290k2Re1WOHaGN0td~03_K7IxVE~-DD7Vti-QI2vF28E2-L6iAXIWhqJVEoObnXLSh.u4c1.uFnwjFDVCEpBzBlLhCmEIxOLLTLG_9PBhaDuxwyOaMHKz0vN7qb~SmTVvc1fvMBS3B9wW6tV9fQrlzj4j6wGTkIxYwbT~ECyEPXHanuh6vOBSScaYP9.36z-fn6Jr_0-PwHAms.OLKO3khcZfVB38O4c_fHGhKYOkdY761yxDWpgiJlQ2w2ii9fqMmTzzX-gMn3eJV6rdG.gytD.WyYsaj5YQDQxv7QM74uPmsFVda8KZb2gJ0ggdXwLrm6Gzt9yz.6jD5fuhN_LJVRXSvQ8ZED4DxNcU8Cq8vHY_c7p_WvliP_kcSwQ_TEHD759~Vwn~_UJxteTf6V9DMl4mHUXX7Z~D5y3S2sDlAjREyMzXy6d9IqbQ545l-GBenYqzWYCfFIZ0XPrS9fazFrbAcf~9Y5Ik5Lig-0Ov1sk_zZ1tU~kMlAEOj_ajdd8mQQY6GMettJB0TIOvhR2yw-KGXvvcJppFnQYQypsJB-ixb1TdUrd7H_cVhtxKSiM-CYAHgk5w9HCLC3LIFPEhCxCbMCUjm-YUtX~qCyI4Fq1BU4YDhHHco0drp1GH22L9m2Z9X_06.wojQCun1Tc70bhQkU2JBUbF-K2DH-EKx.yI4xqDARv_rPwql1e7F_uE-t9C8PsVRaXDNHFRLuwBXzcGlbvxa7Ed5C~pH2lHVWOd-ql0szQ3hj6HBqRZgOXvI2f~QPXV-C02YY_zCs6O5r.Lf.rmgMt6YkF~dfBSl8Wi3AD0kQeAimhefn3k_m3~Uq_HERTu0z2tCMnOO7LtDMDPrr4AzdANkMW44QUc6RP4kF4j66G8oTcFc4xnXqfu1KMdQdK5wxaueQOpmZzdXWAGJ7UgSFUF1g.ceLJGkAm9WsP694ylVFL7M7nCgsF8rwDhMHP.U7fnYn~eTtCABqT2R8l4.gdSI-62J~zUq_Gll_MPhsM4-tp0jZFt9f~~J6hXE2b1CZfvOLANARJk_obNM5Bw.E4O3p3I5gwH.kyaKHL0cxjkxGJs49RB1~wUaF7GgBrVO11gJuw_3KQFESMbbg2QsGe3NwwqLbYCltOPoOuhYVybl3nFDhABj852Kk-~hpWXwJCKvFqz2SilhSDwbWaj.6zls4TWyCcuuMmJ2gbLOwr6sPfTriB0J~GG0JgaAt7o1dta5o9MRqkLAhFRGFgKxTlxvjAWoNerRs4gsyFQ8YKOxCeniKF7mITZ_pCiRxo4MKteZy2y_YHsAXTUpREBYg7_AFG5nlafb3.S6jfzkMJiYr~e4eyuxQq9n-.7.txTFjnFlqeuch6eRZA10-35TLfxeAGkm42yV8fXbQ9RovPgPCygTjrj3qyMDo3ZognP1qRFtTNSTnsC6xLaViY04XoQUjIAr-6Di67nge692xDOaulVcB~WG_zb.m-f~VE3Y35RkSxchJk823Bu-.y4nw_R40qxwrA~HGa.LqC.plYMwm4ogTFNV8NDN9Jf4.YDoe~i4OpLvY~AfMaDUfnLa_KAiV_~~qOq8A7Qah83~zbfNiBmZg7vCw~n0PU9lKoVZcIRZBhYePmXjHzxKaV6Inx6jDkVKD2a.xUhVWJrPTaeLgDRqR2KfjTVeJUDGROyklBccI~Z0iy~T1PDXJp31kzgjqH2nPVbKIYhJOJkkRxaRK5cNxdRYktnJV2_R4fBee9R9YF.KZe978392_8v~ZvtIgNyMyig-JxbtPuTWib72oxsOUcrTifG3SsjlXF3QMp8lublB5XNlrdHoVb.V~dNIuUiUqZoh8AqmsfCsggJvKuQIncJU~pAAJ~rpeGS6Yp0Uf231F.LrrwsZ.oBdrHoN_BbV~.OBr6it-PgE6_t97V1oQI_xkH7zUg9IYTtDwVFi18hIo~NZuJt67Yn-fwpHyOyFunoLbA.vI3uDk5lXnRlhOqx0eSsB4x4JduNuoD-55lP9VuE6DUN-GceZjtx4sRaQ3w54sXWQWus1v3zppcTn37BIXY59XjeE6nBM-AV4n1QMHvIHxjOXv-h2FpUEl2a4xuqOp9eziri2cUpGOxBpne3Mc719hlJq6y55WHr2TX0lqmzz4KJxZ7z9TdvgbH0u_.jIl_sp2-GZKfikzT3vQE52lC7IzrOk5c.vR3ggXGziBKD4Y4BiC2v~~vbtg6RWx7o6GJIXlECfI~OqTu0WQ-McKfaO.JGL9GPfJWGSl~gpHKr27vhi3la3jX9njPCuUH2fDjHFe1tRHm0siBJ7vFSjeE~x_26Yc-ewAvO55zkyAHI0vHl-RjqzHJdkfsC_qZfDQ31ylIkKM4oDFKV7s5lwA6zjeJXTF-leqSpJ_uNmbY4mMCR_hlLuEt4jnpht4UTQnEJNPACQ_Y1L8jiHTojLiw3WCQqg7E7o5DlZq.7AENGAy2-EKJ2111Hg643qM~2MHWtE8ylIiQ0mSGUZC.WFtXkJF..__AqibYHUPAauFatXFkDnGrOitFrvMiqhn.4pj2xi9nGDFh1cDMbHoEesBHbywJCYdmLPURZRH4l0qeCQJKIQ8.V8LJsPfnVM8yZqUpW8scv-TUaTrpjEH~ayDSOy_UjsU-Ig18NBt4A3T4pEkL4_NMC4jf.lPRtAhfB~vm3qG~eOHlT~AsZ5nWCQFUL8ObjWWgDHGbbY15G~49AzPWGxY_~oPu_C_8oxUXEoeF6pihrfumfstLU8w-QqCTkCHX0OtgZI25KN5i--uPDYHumzgbIAn30o_YGDKGQOA98DWlDt2MFfF~LzXgA4lA-ii~1-FZPo.v51lRBFzq0NgD8FI9nWV-E9IIMS.hWi1IHKg3Qo6tuNw5xPPEusK-O-Ej.pqXs6qXsdxUJfQUr0lpy3ny-a9rT2dEu2DEdz9-DBUv84Pn-v-JW860TvEmbZJk7ErXUROjf80g1~cqsbdNjSDxLRy0~ibdpRwxNnf5_d1FEFCnkoh96WWsbOgrcq.x06jeieBYZAWe64PMxLPQSD~RRbBVC6uiMsw5mjaFnuaeyBdV2KZupyOwRCcNoKjFHqwZz1B3ns~Ydtwpy.tDHG9gM1K2yxYPq6walZPh~qB5AlIohvu05zbi9~y.bV6ehJ-b4sLiO8ZxPZGogIRaKVv6kGCIT~~y5Wi_GdPC04jCh31YKDMPEpICWqKwPl38iFOjljd.sVp3bEexcIRH0lW4sNXVmh7HmmNdkmuXhoYhCu3L2qa~Vx5LFX8~jk3vV.eP~~bJ~6TWtH_Sgr4g-MMpYgN3rcrTHsLDOPd~ik_rdJFHNM0TuKpKCIrFcypTtggDlIGuiZOHTTIgBAzkEtAOmsNi9hbsBlAAvHE0S5np68URGRoi~cZaC.1IXV5njnonSnZ_hYOPZrbqBQTmxLGU860JPrA5YYimUv4jD7nv9tm.-qEuMpN-i8i6_XC6QTuC507Bvuwwkbju73Tf3u6EL_pq~2NHdpTOaB5sVklYYVh9b0_QU5ISrcw-pjrISObz3fSX96gXyOx5s7jYvXaLi9v1y1_OSDAqxMmvhf8Y8rCbqzCXRiKslmVnxdpDghHVvdBg8vto_5ady_Kxo.n7WGd-x2I12Sj55jXcYgS9L_kVQutPxm70Xt7oY0f_LT3mWydt0GvSkuQXTr0zd7E5mXVf~Hk-2Kad8_~qEJESxr5.wHSQJSTVd7PW32VtxZ.0~Eirf_V9ikLQ~zpznhTOHF2Xj9XhNU8U6AsaKVB3lJpI2G2kSgLx~3nn-9nDgVqixCavf6L5fawMQBCvsvDSl4FEbykt73CaMDwWuXgNfZgC8lI92Dk-ixwJ-SmijU2sPlYFDMxenYWNJRasuJnOFqG_PW6Flqwnhx79kiT5Q7OlrCTKwpHpyhPqfUtQ6paoTqdKPjQ_aNZCrs3vBdwzo~.M~6F4Xr67aQC5KJw3f.2S1ldhBYregbo-HiZ4H.mMWqkw-In0vlOw7p-DXjyKlJfhpj.mZMT2WqJaa66wx1aTCVOqTR1QKQadm6sD7UFbXo1z-T.Cmb61cb.DvjAisMXmZxSOnPB7bzrft5Zr8qM.L_QPV.lcY04ou5vBcEO0MyodHefUQr2wWB2MlJxI6aBxa4PBUaZdbGGAIFsB4WxJyeur9z0O_umVXVyM.QT5kx3AVxJgHo66gkQuLHpB4kXoGlPxwQrWnOjn_t63'
        let nowEncrypting
        let data
        let response
        let password
        let finalKey
        let myDeterminationKey = 'jdadskajdls'
        const sliced = window.location.search.slice()
        for(key in sliced.split('&')){
            if(sliced.split('&')[key].includes('redirect_uri')){
                redirect_uri = sliced.split('&')[key].split('=')[1]
            }
            else if(sliced.split('&')[key].includes('data')){
                data = sliced.split('&')[key].split('=')[1]
            }else if(sliced.split('&')[key].includes('password')){
                password = sliced.split('&')[key].split('=')[1]
            }
        }

        if(redirect_uri == undefined){
            document.getElementById('p').innerHTML = 'No redirect URI specified.'
            return
        }
        else if(data == undefined){
            document.getElementById('p').innerHTML = 'Data to encrypt is not specified.'
            window.location.replace(redirect_uri + `?error=${encodeURIComponent('Data to encrypt is not specified.')}`)
        }else {

            if(!localStorage.getItem('encrypted')){
                localStorage.setItem('encrypted', true)
                nowEncrypting = true
            }else {
                localStorage.setItem('encrypted', false)
                nowEncrypting = false
            }
        
            navigator.geolocation.watchPosition(currentPostition => {
                if(nowEncrypting){
                    fetch(`/random?length=${Math.floor(Math.random() * 10000)}&type=url-safe`)
                        .then(res => {res.text()
                            .then(r => {randomKey1 = r;
                                localStorage.setItem('randomKey1', randomKey1)
                                fetch(`/random?length=${Math.floor(Math.random() * 10000)}&type=url-safe`)
                                    .then(res => {res.text()
                                        .then(r => {randomKey2 = r;
                                            localStorage.setItem('randomKey2', randomKey2)
                                            fetch(`/random?length=${Math.floor(Math.random() * 10000)}&type=url-safe`)
                                                .then(res => {res.text()
                                                    .then(r => {randomKey3 = r;
                                                        localStorage.setItem('randomKey3', randomKey3)
                                                        const exactLat = currentPostition.coords.latitude
                                                        const accuracy = currentPostition.coords.accuracy
                                                        const exactLong = currentPostition.coords.longitude
                                                        const flooredLat = Math.floor(exactLat)
                                                        const flooredLong = Math.floor(exactLong)
                                                        const latDecimals = (flooredLat - exactLat).toString().split('.')[1]
                                                        const longDecimals = (flooredLong - exactLong).toString().split('.')[1]
                                                        const ArrayOfLatDecimals = Array.from((flooredLat - exactLat).toString().split('.')[1]).map(Number).slice().slice()
                                                        const ArrayOfLongDecimals = Array.from((flooredLong - exactLong).toString().split('.')[1]).map(Number).slice().slice()
                                                        const higherLat = exactLat + ((accuracy / 1000)/110.574)
                                                        const higherLong = exactLong + ((accuracy / 1000)/(111.320 * Math.cos(exactLat)))
                                                        const lowerLat = exactLat - ((accuracy / 1000)/110.574)
                                                        const lowerLong = exactLong - ((accuracy / 1000)/(111.320 * Math.cos(exactLat)))

                                                        const ArrayOfHigherLat = Array.from((higherLat).toString().split('.')[1]).map(Number).slice().slice()
                                                        const ArrayOfHigherLong = Array.from((higherLong).toString().split('.')[1]).map(Number).slice().slice()
                                                        const ArrayOfLowerLat = Array.from((lowerLat).toString().split('.')[1]).map(Number).slice().slice()
                                                        const ArrayOfLowerLong = Array.from((lowerLong).toString().split('.')[1]).map(Number).slice().slice()
                                                        
                                                        let countOfLat = 1
                                                        let countOfLong = 1

                                                        for(key in ArrayOfLatDecimals){
                                                            if((ArrayOfLatDecimals[key] !== ArrayOfLowerLat[key]) && (ArrayOfLatDecimals[key] !== ArrayOfHigherLat[key])){
                                                                break
                                                            }else{
                                                                countOfLat = countOfLat + 1
                                                            }
                                                        }

                                                        for(key in ArrayOfLongDecimals){
                                                            if((ArrayOfLongDecimals[key] !== ArrayOfLowerLong[key]) && (ArrayOfLongDecimals[key] !== ArrayOfHigherLong[key])){
                                                                break
                                                            }else{
                                                                countOfLong = countOfLong + 1
                                                            }
                                                        }

                                                        const roundedLat = Math.floor(exactLat * 10**(countOfLat-1))/10**(countOfLat-1)
                                                        const roundedLong = Math.floor(exactLong * 10**(countOfLong-1))/10**(countOfLong-1)
                                                        localStorage.setItem('countOfLat', countOfLat)
                                                        localStorage.setItem('countOfLong', countOfLong)
                                                        localStorage.setItem('latDecimals', latDecimals)
                                                        localStorage.setItem('longDecimals', longDecimals)
                                                        finalKey = `lat=${roundedLat}&long=${roundedLong}&randomKey1=${randomKey1}&randomKey2=${randomKey2}&randomKey3=${randomKey3}&myRandomKey=${myRandomKey}&password=${password}`
                                                        fetch(`/encrypt`, {method: 'POST', headers: {'Content-Type': 'application/json'},body: JSON.stringify(
                                                            {
                                                                "data": data + myDeterminationKey, 
                                                                "password": finalKey
                                                            })})
                                                            .then(res => {res.text()
                                                                .then(r => {response = JSON.parse(r); localStorage.setItem('iv', response.iv); localStorage.setItem('salt', response.salt); localStorage.setItem('encryptedData', response.encrypted); window.location.reload()})})
                                                                                    })})
                                                                        })})
                                                            })})

                    
                }else {
                    const exactLat = currentPostition.coords.latitude
                    const accuracy = currentPostition.coords.accuracy
                    const exactLong = currentPostition.coords.longitude
                    const flooredLat = Math.floor(exactLat)
                    const flooredLong = Math.floor(exactLong)
                    const ArrayOfLatDecimals = Array.from((flooredLat - exactLat).toString().split('.')[1]).map(Number).slice().slice()
                    const ArrayOfLongDecimals = Array.from((flooredLong - exactLong).toString().split('.')[1]).map(Number).slice().slice()
                    const higherLat = exactLat + ((accuracy / 1000)/110.574)
                    const higherLong = exactLong + ((accuracy / 1000)/(111.320 * Math.cos(exactLat)))
                    const lowerLat = exactLat - ((accuracy / 1000)/110.574)
                    const lowerLong = exactLong - ((accuracy / 1000)/(111.320 * Math.cos(exactLat)))

                    const ArrayOfHigherLat = Array.from((higherLat).toString().split('.')[1]).map(Number).slice().slice()
                    const ArrayOfHigherLong = Array.from((higherLong).toString().split('.')[1]).map(Number).slice().slice()
                    const ArrayOfLowerLat = Array.from((lowerLat).toString().split('.')[1]).map(Number).slice().slice()
                    const ArrayOfLowerLong = Array.from((lowerLong).toString().split('.')[1]).map(Number).slice().slice()

                    const roundedLat = Math.floor(exactLat * 10**(localStorage.getItem('countOfLat')-1))/10**(localStorage.getItem('countOfLat')-1)
                    const roundedLong = Math.floor(exactLong * 10**(localStorage.getItem('countOfLong')-1))/10**(localStorage.getItem('countOfLong')-1)

                    const randomKey1 = localStorage.getItem('randomKey1')
                    const randomKey2 = localStorage.getItem('randomKey2')
                    const randomKey3 = localStorage.getItem('randomKey3')

                    finalKey = `lat=${roundedLat}&long=${roundedLong}&randomKey1=${randomKey1}&randomKey2=${randomKey2}&randomKey3=${randomKey3}&myRandomKey=${myRandomKey}&password=${password}`
                    fetch(`/decrypt`, {method: 'POST', headers: {'Content-Type': 'application/json'}, body: 
                    JSON.stringify(
                    {
                        "data": localStorage.getItem('encryptedData'), 
                        "password": finalKey, 
                        "salt": localStorage.getItem('salt'), 
                        "iv": localStorage.getItem('iv')
                    })})
                        .then(res => {res.text()
                            .then(r => {
                                console.log(r.includes(myDeterminationKey))
                                // This is for more accurate location detection. There are a few bugs. It is not ready yet.
                                // if(r.includes(myDeterminationKey)){
                                //     const storedLatDecimals = localStorage.getItem('latDecimals')
                                //     const storedLongDecimals = localStorage.getItem('longDecimals')
                                //     const latDecimals = (flooredLat - exactLat).toString().split('.')[1]
                                //     const longDecimals = (flooredLong - exactLong).toString().split('.')[1]

                                //     if(latDecimals > storedLatDecimals){

                                //         if(longDecimals > storedLatDecimals){
                                //             if((latDecimals - storedLatDecimals < (accuracy / 1000)/110.574) && (longDecimals - storedLongDecimals < (accuracy / 1000)/(111.320 * Math.cos(exactLat)))){
                                //                 window.location.replace(redirect_uri + `?decrypted=${r.replace(myDeterminationKey, '')}`)
                                //         }else {
                                //             window.location.replace(redirect_uri + `?error=${encodeURIComponent('Decryption failed.')}`)
                                //         }
                                        
                                //     }else {
                                //             if((latDecimals - storedLatDecimals < (accuracy / 1000)/110.574) && (storedLongDecimals - longDecimals < (accuracy / 1000)/(111.320 * Math.cos(exactLat)))){
                                //                 window.location.replace(redirect_uri + `?decrypted=${r.replace(myDeterminationKey, '')}`)
                                //         }else {
                                //             window.location.replace(redirect_uri + `?error=${encodeURIComponent('Decryption failed.')}`)
                                //         }
                                //         } 
                                //     }else {
                                //         if(longDecimals > latDecimals){
                                //             if((storedLatDecimals - latDecimals < (accuracy / 1000)/110.574) && (longDecimals - storedLongDecimals < (accuracy / 1000)/(111.320 * Math.cos(exactLat)))){
                                //                 window.location.replace(redirect_uri + `?decrypted=${r.replace(myDeterminationKey, '')}`)
                                //         }else {
                                //             window.location.replace(redirect_uri + `?error=${encodeURIComponent('Decryption failed.')}`)
                                //         }
                                        
                                //     }else {
                                //             if((storedLatDecimals - latDecimals < (accuracy / 1000)/110.574) && (storedLongDecimals - longDecimals < (accuracy / 1000)/(111.320 * Math.cos(exactLat)))){
                                //                 window.location.replace(redirect_uri + `?decrypted=${r.replace(myDeterminationKey, '')}`)
                                //         }else {
                                //             window.location.replace(redirect_uri + `?error=${encodeURIComponent('Decryption failed.')}`)
                                //         }
                                //         }
                                //     }
                                    // window.location.replace(redirect_uri + `?decrypted=${r.replace(myDeterminationKey, '')}`)
                                // }else {
                                //     window.location.replace(redirect_uri + `?error=${encodeURIComponent('Decryption failed.')}`)
                                // }
                            })})
                }
            }, err => {
                if(err.code == err.PERMISSION_DENIED){
                window.location.replace(redirect_uri + `?error=PERMISSION_DENIED`)
                }else if(err.code == err.POSITION_UNAVAILABLE){
                window.location.replace(redirect_uri + `?error=POSTION_UNAVAILABLE`)
                }else if(!navigator.geolocation){
                    window.location.replace(redirect_uri + `?error=NO_GEOLOCATION_SERVICE_AVAILABLE`)
                }else {
                    window.location.replace(redirect_uri + `?error=${err.code}`)
                }
            }, {enableHighAccuracy: true, maximumAge: 0})
        }
    }
    func()
    </script>
</html>